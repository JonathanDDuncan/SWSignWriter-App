!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{Gj2j:function(n,r,a){"use strict";a.r(r),a.d(r,"SubscribePageModule",function(){return D});var o=a("sYmb"),i=a("ofXK"),c=a("3Pt+"),s=a("tyNb"),u=a("TEn/"),l=a("HaE+"),b=a("Xo/0"),p=a("tk/3"),f=a("qkCY"),m=a("fXoL");function d(e,t){if(1&e){var n=m.Ob();m.Nb(0,"ion-col"),m.pc(1),m.Yb(2,"translate"),m.Nb(3,"ion-button",6),m.Vb("click",function(){return m.ic(n),m.Xb(2).CancelRenewal()}),m.pc(4),m.Yb(5,"translate"),m.Mb(),m.Mb()}if(2&e){var r=m.Xb(2);m.Ab(1),m.sc(" ",m.Zb(2,3,"Your subscription is valid until and will renew on")," ",r.subscriptionEndDate," "),m.Ab(3),m.rc(" ",m.Zb(5,5,"Cancel Automatic Renewal"),"")}}function h(e,t){if(1&e&&(m.Nb(0,"ion-col"),m.pc(1),m.Yb(2,"translate"),m.Mb()),2&e){var n=m.Xb(2);m.Ab(1),m.sc(" ",m.Zb(2,2,"Your subscription is valid until")," ",n.subscriptionEndDate," ")}}function w(e,t){if(1&e&&(m.Nb(0,"ion-row"),m.nc(1,d,6,7,"ion-col",4),m.nc(2,h,3,4,"ng-template",null,5,m.oc),m.Mb()),2&e){var n=m.hc(3),r=m.Xb();m.Ab(1),m.cc("ngIf",r.autoRenewal)("ngIfElse",n)}}var g,v,y=[{path:"",component:(g=function(){function n(t,r,a,o,i,c){e(this,n),this.http=t,this.storage=r,this.alertController=a,this.translateService=o,this.stripeservice=i,this.router=c,this.buttonDisabled=null,this.serverUrl=window.location&&window.location.hostname&&window.location.hostname.includes("localhost")?"https://localhost:44309/":"https://swsignwriterapi.azurewebsites.net/"}var r,a,o;return r=n,(a=[{key:"ngOnInit",value:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark(function t(){var n,r,a,o,i,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.storage.GetCurrentUserProfile();case 2:if(!(n=t.sent)||null===n){t.next=10;break}return t.next=6,e.storage.GetSubscription(n.email);case 6:(r=t.sent)&&(e.SetButtonDisabled(r.endDate),a=new Date(r.endDate),o=new Intl.DateTimeFormat("en",{year:"numeric"}).format(a),i=new Intl.DateTimeFormat("en",{month:"short"}).format(a),c=new Intl.DateTimeFormat("en",{day:"2-digit"}).format(a),e.subscriptionEndDate="".concat(c,"-").concat(i,"-").concat(o),e.autoRenewal=!r.cancelatperiodend),t.next=11;break;case 10:e.router.navigate(["/home"]);case 11:case"end":return t.stop()}},t)}))()}},{key:"SetButtonDisabled",value:function(e){var t=new Date(e)>=new Date;this.buttonDisabled=t}},{key:"SubscribeMonthly",value:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createSession("plan_HHKPHgsv5Vdy49");case 2:case"end":return t.stop()}},t)}))()}},{key:"SubscribeYearly",value:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createSession("plan_HHKPf6K2bmpeN7");case 2:case"end":return t.stop()}},t)}))()}},{key:"createSession",value:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark(function n(){var r,a,o,i,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.storage.GetCurrentUserProfile();case 2:return(r=n.sent)&&null!==r||t.router.navigate(["/login"]),n.next=6,t.storage.GetSubscription(r.email);case 6:return a=n.sent,o=new Date,a&&(o=a.endDate),n.next=11,t.storage.GetTrialStartDate(r.email);case 11:i=n.sent,(c=r).planId=e,c.trialStartDate=i,c.subscriptionEndDate=o,t.http.post(t.serverUrl+"api/stripe/createsession",c,{headers:new p.c({Accept:"application/json","Content-Type":"application/json"})}).subscribe(function(e){console.log(e);var t=e;Stripe("pk_live_Q4UaSLy3gZtg16efKx9JUhCh009AFVCrne").redirectToCheckout({sessionId:t}).then(function(e){e.error?console.log("There was an error with the checkout."):(console.log("Checkout was a success."),console.log(e))})},function(e){console.log(e)});case 14:case"end":return n.stop()}},n)}))()}},{key:"CancelRenewal",value:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.alertController.create({header:e.translateService.instant("Cancel automatic renewal"),message:e.translateService.instant("Are you <strong>sure</strong> you want to remove automatic renewal?"),buttons:[{text:"Disagree",role:"cancel",cssClass:"secondary",handler:function(e){}},{text:"Agree",handler:(r=Object(l.a)(regeneratorRuntime.mark(function t(){var n,r,a,o,i,c,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.storage.GetCurrentUserProfile();case 2:return(n=t.sent)&&null!==n||e.router.navigate(["/login"]),r={privatekey:"**GSew10o0uJiAg4qpTAvQ$KEMaCjC6P7@su2Dd1C9#a8Y$VISWXzYogPhYk&N6p5&cGb1k@nGFX",email:n.email},t.next=7,e.http.post(e.serverUrl+"api/stripe/cancelrenewal",r,{headers:new p.c({Accept:"application/json","Content-Type":"application/json"})}).toPromise();case 7:return e.stripeservice.GetandSaveStripeSubscriptionData(n.email),t.next=10,e.storage.GetSubscription(n.email);case 10:a=t.sent,o=a.endDate,i=new Intl.DateTimeFormat("en",{year:"numeric"}).format(o),c=new Intl.DateTimeFormat("en",{month:"short"}).format(o),s=new Intl.DateTimeFormat("en",{day:"2-digit"}).format(o),e.subscriptionEndDate="".concat(s,"-").concat(c,"-").concat(i),e.autoRenewal=a.CancelAtPeriodEnd,e.SetButtonDisabled(a.endDate);case 16:case"end":return t.stop()}},t)})),function(){return r.apply(this,arguments)})}]});case 2:return n=t.sent,t.next=5,n.present();case 5:case"end":return t.stop()}},t)}))()}}])&&t(r.prototype,a),o&&t(r,o),n}(),g.\u0275fac=function(e){return new(e||g)(m.Kb(p.a),m.Kb(f.a),m.Kb(u.a),m.Kb(o.d),m.Kb(b.a),m.Kb(s.g))},g.\u0275cmp=m.Eb({type:g,selectors:[["app-subscribe"]],decls:29,vars:21,consts:[["slot","start"],["slot","icon-only","name","menu"],[4,"ngIf"],[3,"disabled","click"],[4,"ngIf","ngIfElse"],["validuntil",""],[3,"click"]],template:function(e,t){1&e&&(m.Nb(0,"ion-header"),m.Nb(1,"ion-toolbar"),m.Nb(2,"ion-buttons",0),m.Nb(3,"ion-menu-toggle"),m.Nb(4,"ion-button"),m.Lb(5,"ion-icon",1),m.Mb(),m.Mb(),m.Mb(),m.Nb(6,"ion-title"),m.pc(7),m.Yb(8,"translate"),m.Mb(),m.Mb(),m.Mb(),m.Nb(9,"ion-content"),m.nc(10,w,4,2,"ion-row",2),m.Nb(11,"ion-row"),m.Nb(12,"ion-col"),m.Nb(13,"p"),m.pc(14),m.Yb(15,"translate"),m.Mb(),m.Nb(16,"p"),m.pc(17),m.Yb(18,"translate"),m.Mb(),m.Nb(19,"ion-button",3),m.Vb("click",function(){return t.SubscribeYearly()}),m.pc(20),m.Yb(21,"translate"),m.Mb(),m.Lb(22,"hr"),m.Nb(23,"p"),m.pc(24),m.Yb(25,"translate"),m.Mb(),m.Nb(26,"ion-button",3),m.Vb("click",function(){return t.SubscribeMonthly()}),m.pc(27),m.Yb(28,"translate"),m.Mb(),m.Mb(),m.Mb(),m.Mb()),2&e&&(m.Ab(7),m.qc(m.Zb(8,9,"Subscribe")),m.Ab(3),m.cc("ngIf",t.subscriptionEndDate),m.Ab(4),m.rc("1 ",m.Zb(15,11,"Month FREE"),""),m.Ab(3),m.rc("+ ",m.Zb(18,13,"$5/month for 11 months"),""),m.Ab(2),m.cc("disabled",t.buttonDisabled),m.Ab(1),m.qc(m.Zb(21,15,"Subscribe Yearly")),m.Ab(4),m.rc(" ",m.Zb(25,17,"$5/month"),""),m.Ab(2),m.cc("disabled",t.buttonDisabled),m.Ab(1),m.qc(m.Zb(28,19,"Subscribe Monthly")))},directives:[u.l,u.E,u.e,u.t,u.d,u.m,u.D,u.g,i.k,u.y,u.f],pipes:[o.c],styles:["ion-col[_ngcontent-%COMP%]{text-align:center}"]}),g)}],D=((v=function t(){e(this,t)}).\u0275fac=function(e){return new(e||v)},v.\u0275mod=m.Ib({type:v}),v.\u0275inj=m.Hb({imports:[[i.c,c.a,u.F,o.b,s.j.forChild(y)]]}),v)}}])}();
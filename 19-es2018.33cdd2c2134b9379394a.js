(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{Gj2j:function(t,e,n){"use strict";n.r(e),n.d(e,"SubscribePageModule",function(){return A});var i=n("sYmb"),r=n("ofXK"),a=n("3Pt+"),s=n("tyNb"),o=n("TEn/"),c=n("HaE+"),b=n("Xo/0"),l=n("tk/3"),u=n("qkCY"),p=n("HtUY"),d=n("Blvj"),h=n("fXoL");function f(t,e){1&t&&(h.Nb(0,"p"),h.pc(1,"You can start a 15 day free trial"),h.Mb())}function S(t,e){if(1&t){const t=h.Ob();h.Nb(0,"ion-button",6),h.Vb("click",function(){return h.ic(t),h.Xb().StartTrial()}),h.pc(1),h.Yb(2,"translate"),h.Mb()}2&t&&(h.Ab(1),h.rc("",h.Zb(2,1,"Start Trial")," "))}function g(t,e){if(1&t&&(h.Nb(0,"p"),h.pc(1),h.Mb()),2&t){const t=h.Xb();h.Ab(1),h.rc("Your free trial has ",t.trialDaysLeft," days left")}}function y(t,e){if(1&t){const t=h.Ob();h.Nb(0,"ion-col"),h.pc(1),h.Yb(2,"translate"),h.Nb(3,"ion-button",6),h.Vb("click",function(){return h.ic(t),h.Xb(3).CancelRenewal()}),h.pc(4),h.Yb(5,"translate"),h.Mb(),h.Mb()}if(2&t){const t=h.Xb(3);h.Ab(1),h.sc(" ",h.Zb(2,3,"Your subscription is valid until and will renew on")," ",t.subscriptionEndDate,". Cancelling your subscription will have an effect inmediately. "),h.Ab(3),h.rc(" ",h.Zb(5,5,"Cancel Automatic Renewal"),"")}}function v(t,e){if(1&t&&(h.Nb(0,"ion-col"),h.pc(1),h.Yb(2,"translate"),h.Mb()),2&t){const t=h.Xb(3);h.Ab(1),h.sc(" ",h.Zb(2,2,"Your subscription is valid until")," ",t.subscriptionEndDate," ")}}function w(t,e){if(1&t&&(h.Nb(0,"ion-row"),h.nc(1,y,6,7,"ion-col",4),h.nc(2,v,3,4,"ng-template",null,8,h.oc),h.Mb()),2&t){const t=h.hc(3),e=h.Xb(2);h.Ab(1),h.cc("ngIf",e.autoRenewal)("ngIfElse",t)}}function m(t,e){if(1&t){const t=h.Ob();h.Nb(0,"div"),h.nc(1,w,4,2,"ion-row",2),h.Nb(2,"ion-row"),h.Nb(3,"ion-col"),h.Nb(4,"p"),h.pc(5),h.Yb(6,"translate"),h.Mb(),h.Nb(7,"p"),h.pc(8),h.Yb(9,"translate"),h.Mb(),h.Nb(10,"ion-button",7),h.Vb("click",function(){return h.ic(t),h.Xb().SubscribeYearly()}),h.pc(11),h.Yb(12,"translate"),h.Mb(),h.Lb(13,"hr"),h.Nb(14,"p"),h.pc(15),h.Yb(16,"translate"),h.Mb(),h.Nb(17,"ion-button",7),h.Vb("click",function(){return h.ic(t),h.Xb().SubscribeMonthly()}),h.pc(18),h.Yb(19,"translate"),h.Mb(),h.Mb(),h.Mb(),h.Mb()}if(2&t){const t=h.Xb();h.Ab(1),h.cc("ngIf",t.subscriptionEndDate),h.Ab(4),h.rc("1 ",h.Zb(6,8,"Month FREE"),""),h.Ab(3),h.rc("+ ",h.Zb(9,10,"$5/month for 11 months"),""),h.Ab(2),h.cc("disabled",t.buttonDisabled),h.Ab(1),h.qc(h.Zb(12,12,"Subscribe Yearly")),h.Ab(4),h.rc(" ",h.Zb(16,14,"$5/month"),""),h.Ab(2),h.cc("disabled",t.buttonDisabled),h.Ab(1),h.qc(h.Zb(19,16,"Subscribe Monthly"))}}function M(t,e){1&t&&(h.Nb(0,"ion-col"),h.Nb(1,"p"),h.pc(2,"You own a Google Play subscription"),h.Mb(),h.Mb())}const T=[{path:"",component:(()=>{class t{constructor(t,e,n,i,r,a,s,o){this.http=t,this.storage=e,this.alertController=n,this.translateService=i,this.stripeservice=r,this.router=a,this.subscriptionService=s,this.trialService=o,this.buttonDisabled=null,this.showTrialButton=!1,this.hasStartedTrial=!1,this.trialDaysLeft=0,this.serverUrl="https://swsignwriterapi.azurewebsites.net/"}ngOnInit(){var t=this;return Object(c.a)(function*(){t.subscriptionService.autoRenewal.subscribe(e=>t.autoRenewal=e),t.subscriptionService.subscriptionEndDate.subscribe(e=>{if(e){const n=new Intl.DateTimeFormat("en",{year:"numeric"}).format(e),i=new Intl.DateTimeFormat("en",{month:"short"}).format(e),r=new Intl.DateTimeFormat("en",{day:"2-digit"}).format(e);t.subscriptionEndDate=`${r}-${i}-${n}`}}),t.SetButtonDisabled(),yield t.ShowTrialButton()})()}ShowTrialButton(){var t=this;return Object(c.a)(function*(){var e=yield t.storage.GetCurrentUserProfile();t.hasStartedTrial=yield t.trialService.HasStartedTrial(e.sub),t.showTrialButton=!t.subscriptionService.isSubscribed.getValue()&&!t.hasStartedTrial,t.hasStartedTrial&&(t.trialDaysLeft=yield t.trialService.GetTrialDaysLeft(e.sub))})()}StartTrial(){var t=this;return Object(c.a)(function*(){var e=yield t.storage.GetCurrentUserProfile();null!==(yield t.trialService.StartTrial(e.sub)).TrialStartDate&&(t.showAlert(),t.ShowTrialButton())})()}showAlert(){var t=this;return Object(c.a)(function*(){const e=yield t.alertController.create({header:"Alert",subHeader:"SubTitle",message:"This is an alert message",buttons:["OK"]});yield e.present();const n=yield e.onDidDismiss();console.log(n)})()}SetButtonDisabled(){this.subscriptionService.isSubscribed.subscribe(t=>{this.buttonDisabled=t})}SubscribeMonthly(){var t=this;return Object(c.a)(function*(){yield t.createSession("plan_GEcB3WZYgKsVER")})()}SubscribeYearly(){var t=this;return Object(c.a)(function*(){yield t.createSession("plan_GEcEaSP0i9BI5L")})()}createSession(t){var e=this;return Object(c.a)(function*(){const n=yield e.storage.GetCurrentUserProfile();n&&null!==n||e.router.navigate(["/login"]);const i=yield e.storage.GetSubscription(n.email);let r=new Date;i&&(r=i.endDate);const a=yield e.storage.GetTrialStartDate(n.email),s=n;s.planId=t,s.trialStartDate=a,s.subscriptionEndDate=r,e.http.post(e.serverUrl+"api/stripe/createsession",s,{headers:new l.c({Accept:"application/json","Content-Type":"application/json"})}).subscribe(t=>{console.log(t);const e=t;Stripe("pk_live_Q4UaSLy3gZtg16efKx9JUhCh009AFVCrne").redirectToCheckout({sessionId:e}).then(function(t){t.error?console.log("There was an error with the checkout."):(console.log("Checkout was a success."),console.log(t))})},t=>{console.log(t)})})()}CancelRenewal(){var t=this;return Object(c.a)(function*(){const e=yield t.alertController.create({header:t.translateService.instant("Cancel automatic renewal"),message:t.translateService.instant("Are you <strong>sure</strong> you want to remove automatic renewal?"),buttons:[{text:"Disagree",role:"cancel",cssClass:"secondary",handler:t=>{}},{text:"Agree",handler:(n=Object(c.a)(function*(){const e=yield t.storage.GetCurrentUserProfile();e&&null!==e||t.router.navigate(["/login"]);const n={privatekey:"**GSew10o0uJiAg4qpTAvQ$KEMaCjC6P7@su2Dd1C9#a8Y$VISWXzYogPhYk&N6p5&cGb1k@nGFX",email:e.email};yield t.http.post(t.serverUrl+"api/stripe/cancelrenewal",n,{headers:new l.c({Accept:"application/json","Content-Type":"application/json"})}).toPromise(),t.stripeservice.GetandSaveStripeSubscriptionData(e.email),t.subscriptionService.checkSubscription()}),function(){return n.apply(this,arguments)})}]});var n;yield e.present()})()}}return t.\u0275fac=function(e){return new(e||t)(h.Kb(l.a),h.Kb(u.a),h.Kb(o.a),h.Kb(i.d),h.Kb(b.a),h.Kb(s.g),h.Kb(p.a),h.Kb(d.a))},t.\u0275cmp=h.Eb({type:t,selectors:[["app-subscribe"]],decls:18,vars:8,consts:[["slot","start"],["slot","icon-only","name","menu"],[4,"ngIf"],[3,"click",4,"ngIf"],[4,"ngIf","ngIfElse"],["androidSubscribed",""],[3,"click"],[3,"disabled","click"],["validuntil",""]],template:function(t,e){if(1&t&&(h.Nb(0,"ion-header"),h.Nb(1,"ion-toolbar"),h.Nb(2,"ion-buttons",0),h.Nb(3,"ion-menu-toggle"),h.Nb(4,"ion-button"),h.Lb(5,"ion-icon",1),h.Mb(),h.Mb(),h.Mb(),h.Nb(6,"ion-title"),h.pc(7),h.Yb(8,"translate"),h.Mb(),h.Mb(),h.Mb(),h.Nb(9,"ion-content"),h.Nb(10,"ion-row"),h.Nb(11,"ion-col"),h.nc(12,f,2,0,"p",2),h.nc(13,S,3,3,"ion-button",3),h.nc(14,g,2,1,"p",2),h.Mb(),h.Mb(),h.nc(15,m,20,18,"div",4),h.nc(16,M,3,0,"ng-template",null,5,h.oc),h.Mb()),2&t){const t=h.hc(17);h.Ab(7),h.qc(h.Zb(8,6,"Subscribe")),h.Ab(5),h.cc("ngIf",e.showTrialButton),h.Ab(1),h.cc("ngIf",e.showTrialButton),h.Ab(1),h.cc("ngIf",e.hasStartedTrial&&e.trialDaysLeft>0&&!e.subscriptionService.isSubscribed.getValue()),h.Ab(1),h.cc("ngIf",!("Android"===e.subscriptionService.subscriptionType.getValue()))("ngIfElse",t)}},directives:[o.l,o.E,o.e,o.t,o.d,o.m,o.D,o.g,o.y,o.f,r.k],pipes:[i.c],styles:["ion-col[_ngcontent-%COMP%]{text-align:center}"]}),t})()}];let A=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=h.Ib({type:t}),t.\u0275inj=h.Hb({imports:[[r.c,a.a,o.F,i.b,s.j.forChild(T)]]}),t})()}}]);
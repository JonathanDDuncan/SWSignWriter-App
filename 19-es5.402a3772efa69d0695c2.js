!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{Gj2j:function(n,r,a){"use strict";a.r(r),a.d(r,"SubscribePageModule",function(){return N});var i=a("sYmb"),o=a("ofXK"),c=a("3Pt+"),s=a("tyNb"),u=a("TEn/"),b=a("HaE+"),l=a("Xo/0"),p=a("tk/3"),f=a("qkCY"),h=a("HtUY"),v=a("Blvj"),d=a("fXoL");function g(e,t){1&e&&(d.Nb(0,"p"),d.pc(1,"You can start a 15 day free trial"),d.Mb())}function m(e,t){if(1&e){var n=d.Ob();d.Nb(0,"ion-button",6),d.Vb("click",function(){return d.ic(n),d.Xb().StartTrial()}),d.pc(1),d.Yb(2,"translate"),d.Mb()}2&e&&(d.Ab(1),d.rc("",d.Zb(2,1,"Start Trial")," "))}function w(e,t){if(1&e&&(d.Nb(0,"p"),d.pc(1),d.Mb()),2&e){var n=d.Xb();d.Ab(1),d.rc("Your free trial has ",n.trialDaysLeft," days left")}}function S(e,t){if(1&e){var n=d.Ob();d.Nb(0,"ion-col"),d.pc(1),d.Yb(2,"translate"),d.Nb(3,"ion-button",6),d.Vb("click",function(){return d.ic(n),d.Xb(3).CancelRenewal()}),d.pc(4),d.Yb(5,"translate"),d.Mb(),d.Mb()}if(2&e){var r=d.Xb(3);d.Ab(1),d.sc(" ",d.Zb(2,3,"Your subscription is valid until and will renew on")," ",r.subscriptionEndDate,". Cancelling your subscription will have an effect inmediately. "),d.Ab(3),d.rc(" ",d.Zb(5,5,"Cancel Automatic Renewal"),"")}}function y(e,t){if(1&e&&(d.Nb(0,"ion-col"),d.pc(1),d.Yb(2,"translate"),d.Mb()),2&e){var n=d.Xb(3);d.Ab(1),d.sc(" ",d.Zb(2,2,"Your subscription is valid until")," ",n.subscriptionEndDate," ")}}function k(e,t){if(1&e&&(d.Nb(0,"ion-row"),d.nc(1,S,6,7,"ion-col",4),d.nc(2,y,3,4,"ng-template",null,8,d.oc),d.Mb()),2&e){var n=d.hc(3),r=d.Xb(2);d.Ab(1),d.cc("ngIf",r.autoRenewal)("ngIfElse",n)}}function x(e,t){if(1&e){var n=d.Ob();d.Nb(0,"div"),d.nc(1,k,4,2,"ion-row",2),d.Nb(2,"ion-row"),d.Nb(3,"ion-col"),d.Nb(4,"p"),d.pc(5),d.Yb(6,"translate"),d.Mb(),d.Nb(7,"p"),d.pc(8),d.Yb(9,"translate"),d.Mb(),d.Nb(10,"ion-button",7),d.Vb("click",function(){return d.ic(n),d.Xb().SubscribeYearly()}),d.pc(11),d.Yb(12,"translate"),d.Mb(),d.Lb(13,"hr"),d.Nb(14,"p"),d.pc(15),d.Yb(16,"translate"),d.Mb(),d.Nb(17,"ion-button",7),d.Vb("click",function(){return d.ic(n),d.Xb().SubscribeMonthly()}),d.pc(18),d.Yb(19,"translate"),d.Mb(),d.Mb(),d.Mb(),d.Mb()}if(2&e){var r=d.Xb();d.Ab(1),d.cc("ngIf",r.subscriptionEndDate),d.Ab(4),d.rc("1 ",d.Zb(6,8,"Month FREE"),""),d.Ab(3),d.rc("+ ",d.Zb(9,10,"$5/month for 11 months"),""),d.Ab(2),d.cc("disabled",r.buttonDisabled),d.Ab(1),d.qc(d.Zb(12,12,"Subscribe Yearly")),d.Ab(4),d.rc(" ",d.Zb(16,14,"$5/month"),""),d.Ab(2),d.cc("disabled",r.buttonDisabled),d.Ab(1),d.qc(d.Zb(19,16,"Subscribe Monthly"))}}function M(e,t){1&e&&(d.Nb(0,"ion-col"),d.Nb(1,"p"),d.pc(2,"You own a Google Play subscription"),d.Mb(),d.Mb())}var T,A,D=[{path:"",component:(T=function(){function n(t,r,a,i,o,c,s,u){e(this,n),this.http=t,this.storage=r,this.alertController=a,this.translateService=i,this.stripeservice=o,this.router=c,this.subscriptionService=s,this.trialService=u,this.buttonDisabled=null,this.showTrialButton=!1,this.hasStartedTrial=!1,this.trialDaysLeft=0,this.serverUrl="https://swsignwriterapi.azurewebsites.net/"}var r,a,i;return r=n,(a=[{key:"ngOnInit",value:function(){var e=this;return Object(b.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.subscriptionService.autoRenewal.subscribe(function(t){return e.autoRenewal=t}),e.subscriptionService.subscriptionEndDate.subscribe(function(t){if(t){var n=new Intl.DateTimeFormat("en",{year:"numeric"}).format(t),r=new Intl.DateTimeFormat("en",{month:"short"}).format(t),a=new Intl.DateTimeFormat("en",{day:"2-digit"}).format(t);e.subscriptionEndDate="".concat(a,"-").concat(r,"-").concat(n)}}),e.SetButtonDisabled(),t.next=5,e.ShowTrialButton();case 5:case"end":return t.stop()}},t)}))()}},{key:"ShowTrialButton",value:function(){var e=this;return Object(b.a)(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.storage.GetCurrentUserProfile();case 2:return n=t.sent,t.next=5,e.trialService.HasStartedTrial(n.sub);case 5:if(e.hasStartedTrial=t.sent,e.showTrialButton=!e.subscriptionService.isSubscribed.getValue()&&!e.hasStartedTrial,t.t0=e.hasStartedTrial,!t.t0){t.next=12;break}return t.next=11,e.trialService.GetTrialDaysLeft(n.sub);case 11:e.trialDaysLeft=t.sent;case 12:case"end":return t.stop()}},t)}))()}},{key:"StartTrial",value:function(){var e=this;return Object(b.a)(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.storage.GetCurrentUserProfile();case 2:return n=t.sent,t.next=5,e.trialService.StartTrial(n.sub);case 5:if(t.t0=t.sent.TrialStartDate,t.t1=null!==t.t0,!t.t1){t.next=9;break}e.showAlert(),e.ShowTrialButton();case 9:case"end":return t.stop()}},t)}))()}},{key:"showAlert",value:function(){var e=this;return Object(b.a)(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.alertController.create({header:"Alert",subHeader:"SubTitle",message:"This is an alert message",buttons:["OK"]});case 2:return n=t.sent,t.next=5,n.present();case 5:return t.next=7,n.onDidDismiss();case 7:r=t.sent,console.log(r);case 9:case"end":return t.stop()}},t)}))()}},{key:"SetButtonDisabled",value:function(){var e=this;this.subscriptionService.isSubscribed.subscribe(function(t){e.buttonDisabled=t})}},{key:"SubscribeMonthly",value:function(){var e=this;return Object(b.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createSession("plan_HHKPHgsv5Vdy49");case 2:case"end":return t.stop()}},t)}))()}},{key:"SubscribeYearly",value:function(){var e=this;return Object(b.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createSession("plan_HHKPf6K2bmpeN7");case 2:case"end":return t.stop()}},t)}))()}},{key:"createSession",value:function(e){var t=this;return Object(b.a)(regeneratorRuntime.mark(function n(){var r,a,i,o,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.storage.GetCurrentUserProfile();case 2:return(r=n.sent)&&null!==r||t.router.navigate(["/login"]),n.next=6,t.storage.GetSubscription(r.email);case 6:return a=n.sent,i=new Date,a&&(i=a.endDate),n.next=11,t.storage.GetTrialStartDate(r.email);case 11:o=n.sent,(c=r).planId=e,c.trialStartDate=o,c.subscriptionEndDate=i,t.http.post(t.serverUrl+"api/stripe/createsession",c,{headers:new p.c({Accept:"application/json","Content-Type":"application/json"})}).subscribe(function(e){console.log(e);var t=e;Stripe("pk_live_Q4UaSLy3gZtg16efKx9JUhCh009AFVCrne").redirectToCheckout({sessionId:t}).then(function(e){e.error?console.log("There was an error with the checkout."):(console.log("Checkout was a success."),console.log(e))})},function(e){console.log(e)});case 14:case"end":return n.stop()}},n)}))()}},{key:"CancelRenewal",value:function(){var e=this;return Object(b.a)(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.alertController.create({header:e.translateService.instant("Cancel automatic renewal"),message:e.translateService.instant("Are you <strong>sure</strong> you want to remove automatic renewal?"),buttons:[{text:"Disagree",role:"cancel",cssClass:"secondary",handler:function(e){}},{text:"Agree",handler:(r=Object(b.a)(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.storage.GetCurrentUserProfile();case 2:return(n=t.sent)&&null!==n||e.router.navigate(["/login"]),r={privatekey:"**GSew10o0uJiAg4qpTAvQ$KEMaCjC6P7@su2Dd1C9#a8Y$VISWXzYogPhYk&N6p5&cGb1k@nGFX",email:n.email},t.next=7,e.http.post(e.serverUrl+"api/stripe/cancelrenewal",r,{headers:new p.c({Accept:"application/json","Content-Type":"application/json"})}).toPromise();case 7:e.stripeservice.GetandSaveStripeSubscriptionData(n.email),e.subscriptionService.checkSubscription();case 9:case"end":return t.stop()}},t)})),function(){return r.apply(this,arguments)})}]});case 2:return n=t.sent,t.next=5,n.present();case 5:case"end":return t.stop()}},t)}))()}}])&&t(r.prototype,a),i&&t(r,i),n}(),T.\u0275fac=function(e){return new(e||T)(d.Kb(p.a),d.Kb(f.a),d.Kb(u.a),d.Kb(i.d),d.Kb(l.a),d.Kb(s.g),d.Kb(h.a),d.Kb(v.a))},T.\u0275cmp=d.Eb({type:T,selectors:[["app-subscribe"]],decls:18,vars:8,consts:[["slot","start"],["slot","icon-only","name","menu"],[4,"ngIf"],[3,"click",4,"ngIf"],[4,"ngIf","ngIfElse"],["androidSubscribed",""],[3,"click"],[3,"disabled","click"],["validuntil",""]],template:function(e,t){if(1&e&&(d.Nb(0,"ion-header"),d.Nb(1,"ion-toolbar"),d.Nb(2,"ion-buttons",0),d.Nb(3,"ion-menu-toggle"),d.Nb(4,"ion-button"),d.Lb(5,"ion-icon",1),d.Mb(),d.Mb(),d.Mb(),d.Nb(6,"ion-title"),d.pc(7),d.Yb(8,"translate"),d.Mb(),d.Mb(),d.Mb(),d.Nb(9,"ion-content"),d.Nb(10,"ion-row"),d.Nb(11,"ion-col"),d.nc(12,g,2,0,"p",2),d.nc(13,m,3,3,"ion-button",3),d.nc(14,w,2,1,"p",2),d.Mb(),d.Mb(),d.nc(15,x,20,18,"div",4),d.nc(16,M,3,0,"ng-template",null,5,d.oc),d.Mb()),2&e){var n=d.hc(17);d.Ab(7),d.qc(d.Zb(8,6,"Subscribe")),d.Ab(5),d.cc("ngIf",t.showTrialButton),d.Ab(1),d.cc("ngIf",t.showTrialButton),d.Ab(1),d.cc("ngIf",t.hasStartedTrial&&t.trialDaysLeft>0&&!t.subscriptionService.isSubscribed.getValue()),d.Ab(1),d.cc("ngIf",!("Android"===t.subscriptionService.subscriptionType.getValue()))("ngIfElse",n)}},directives:[u.l,u.E,u.e,u.t,u.d,u.m,u.D,u.g,u.y,u.f,o.k],pipes:[i.c],styles:["ion-col[_ngcontent-%COMP%]{text-align:center}"]}),T)}],N=((A=function t(){e(this,t)}).\u0275fac=function(e){return new(e||A)},A.\u0275mod=d.Ib({type:A}),A.\u0275inj=d.Hb({imports:[[o.c,c.a,u.F,i.b,s.j.forChild(D)]]}),A)}}])}();